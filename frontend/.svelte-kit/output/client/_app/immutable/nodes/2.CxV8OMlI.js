import{a as M,f as O,c as Ze,b as Ne}from"../chunks/SldK7h0U.js";import{o as et}from"../chunks/DfM9hz9f.js";import{m as $,J as tt,G as at,g as s,K as rt,M as st,N as Ie,O as Ae,P as ne,o as te,a1 as nt,a2 as it,a3 as Me,f as lt,l as oe,a4 as ot,v as dt,_ as vt,a5 as ct,a6 as ce,a7 as ft,a8 as Se,a9 as ut,aa as pt,ab as ht,k as Be,ac as L,h as Oe,j as je,ad as ie,ae as gt,af as xt,i as mt,ag as _t,t as U,e as o,c as x,r as d,I as de,n as He,p as bt,s as H,b as wt,a as yt,d as k,ah as kt,u as ae}from"../chunks/CZ8iVQTt.js";import{d as Ve,s as P,a as X}from"../chunks/MdFL1Qgq.js";import{i as W}from"../chunks/DwbYP2Bb.js";import{B as Ct,b as Et,s as le,r as It,a as At,c as Te}from"../chunks/C56Qi1d0.js";import{s as R}from"../chunks/BfHaHi3u.js";function Mt(e,i){return i}function St(e,i,r){for(var g=[],_=i.length,p,c=i.length,a=0;a<_;a++){let h=i[a];je(h,()=>{if(p){if(p.pending.delete(h),p.done.add(h),p.pending.size===0){var S=e.outrogroups;ve(ce(p.done)),S.delete(p),S.size===0&&(e.outrogroups=null)}}else c-=1},!1)}if(c===0){var n=g.length===0&&r!==null;if(n){var v=r,f=v.parentNode;xt(f),f.append(v),e.items.clear()}ve(i,!n)}else p={pending:new Set(i),done:new Set},(e.outrogroups??=new Set).add(p)}function ve(e,i=!0){for(var r=0;r<e.length;r++)mt(e[r],i)}var Fe;function Bt(e,i,r,g,_,p=null){var c=e,a=new Map;$&&tt();var n=null,v=vt(()=>{var m=r();return ct(m)?m:m==null?[]:ce(m)}),f,h=!0;function S(){t.fallback=n,Tt(t,f,c,i,g),n!==null&&(f.length===0?(n.f&L)===0?Oe(n):(n.f^=L,Q(n,null,c)):je(n,()=>{n=null}))}var T=at(()=>{f=s(v);var m=f.length;let y=!1;if($){var C=rt(c)===st;C!==(m===0)&&(c=Ie(),Ae(c),ne(!1),y=!0)}for(var b=new Set,A=lt,B=dt(),E=0;E<m;E+=1){$&&te.nodeType===nt&&te.data===it&&(c=te,y=!0,ne(!1));var j=f[E],F=g(j,E),w=h?null:a.get(F);w?(w.v&&Me(w.v,j),w.i&&Me(w.i,E),B&&A.unskip_effect(w.e)):(w=Ft(a,h?c:Fe??=Be(),j,F,E,_,i,r),h||(w.e.f|=L),a.set(F,w)),b.add(F)}if(m===0&&p&&!n&&(h?n=oe(()=>p(c)):(n=oe(()=>p(Fe??=Be())),n.f|=L)),m>b.size&&ot(),$&&m>0&&Ae(Ie()),!h)if(B){for(const[Z,Y]of a)b.has(Z)||A.skip_effect(Y.e);A.oncommit(S),A.ondiscard(()=>{})}else S();y&&ne(!0),s(v)}),t={effect:T,items:a,outrogroups:null,fallback:n};h=!1,$&&(c=te)}function K(e){for(;e!==null&&(e.f&gt)===0;)e=e.next;return e}function Tt(e,i,r,g,_){var p=i.length,c=e.items,a=K(e.effect.first),n,v=null,f=[],h=[],S,T,t,m;for(m=0;m<p;m+=1){if(S=i[m],T=_(S,m),t=c.get(T).e,e.outrogroups!==null)for(const w of e.outrogroups)w.pending.delete(t),w.done.delete(t);if((t.f&L)!==0)if(t.f^=L,t===a)Q(t,null,r);else{var y=v?v.next:a;t===e.effect.last&&(e.effect.last=t.prev),t.prev&&(t.prev.next=t.next),t.next&&(t.next.prev=t.prev),D(e,v,t),D(e,t,y),Q(t,y,r),v=t,f=[],h=[],a=K(v.next);continue}if((t.f&ie)!==0&&Oe(t),t!==a){if(n!==void 0&&n.has(t)){if(f.length<h.length){var C=h[0],b;v=C.prev;var A=f[0],B=f[f.length-1];for(b=0;b<f.length;b+=1)Q(f[b],C,r);for(b=0;b<h.length;b+=1)n.delete(h[b]);D(e,A.prev,B.next),D(e,v,A),D(e,B,C),a=C,v=B,m-=1,f=[],h=[]}else n.delete(t),Q(t,a,r),D(e,t.prev,t.next),D(e,t,v===null?e.effect.first:v.next),D(e,v,t),v=t;continue}for(f=[],h=[];a!==null&&a!==t;)(n??=new Set).add(a),h.push(a),a=K(a.next);if(a===null)continue}(t.f&L)===0&&f.push(t),v=t,a=K(t.next)}if(e.outrogroups!==null){for(const w of e.outrogroups)w.pending.size===0&&(ve(ce(w.done)),e.outrogroups?.delete(w));e.outrogroups.size===0&&(e.outrogroups=null)}if(a!==null||n!==void 0){var E=[];if(n!==void 0)for(t of n)(t.f&ie)===0&&E.push(t);for(;a!==null;)(a.f&ie)===0&&a!==e.fallback&&E.push(a),a=K(a.next);var j=E.length;if(j>0){var F=null;St(e,E,F)}}}function Ft(e,i,r,g,_,p,c,a){var n=(c&ut)!==0?(c&pt)===0?ht(r,!1,!1):Se(r):null,v=(c&ft)!==0?Se(_):null;return{v:n,i:v,e:oe(()=>(p(i,n??r,v??_,a),()=>{e.delete(g)}))}}function Q(e,i,r){if(e.nodes)for(var g=e.nodes.start,_=e.nodes.end,p=i&&(i.f&L)===0?i.nodes.start:r;g!==null;){var c=_t(g);if(p.before(g),g===_)return;g=c}}function D(e,i,r){i===null?e.effect.first=r:i.next=r,r===null?e.effect.last=i:r.prev=i}var Nt=O('<div class="hidden md:flex flex-col items-end"><span class="text-xs font-bold uppercase tracking-wider text-slate-400">Account</span> <span class="text-sm font-semibold text-slate-600"> </span></div> <div class="h-10 w-px bg-slate-200 hidden md:block"></div>',1),Ot=O('<button class="text-sm font-bold text-slate-400 hover:text-red-500 transition-all">Sign Out</button>'),jt=O('<a href="/login" class="text-sm font-bold text-primary hover:text-primary/80 transition-all">Sign In</a>'),Ht=O('<header class="glass sticky top-0 z-50 border-b border-white/40"><div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 h-20 flex items-center justify-between"><a href="/" class="flex items-center gap-3 hover:opacity-80 transition-opacity"><div class="w-10 h-10 bg-primary rounded-xl flex items-center justify-center shadow-lg shadow-primary/20"><svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"></path></svg></div> <h1 class="text-2xl font-extrabold tracking-tight text-primary"> </h1></a> <div class="flex items-center gap-6"><!> <div class="flex items-center gap-3"><span class="flex items-center gap-1.5 text-sm font-bold bg-primary/10 text-primary px-4 py-2 rounded-full border border-primary/10"><span class="w-2 h-2 rounded-full bg-primary animate-pulse"></span> </span> <!></div></div></div></header>');function Vt(e,i){var r=Ht(),g=o(r),_=o(g),p=x(o(_),2),c=o(p,!0);d(p),d(_);var a=x(_,2),n=o(a);{var v=y=>{var C=Nt(),b=de(C),A=x(o(b),2),B=o(A,!0);d(A),d(b),He(2),U(()=>P(B,i.email)),M(y,C)};W(n,y=>{i.isLoggedIn&&y(v)})}var f=x(n,2),h=o(f),S=x(o(h));d(h);var T=x(h,2);{var t=y=>{var C=Ot();X("click",C,function(...b){i.onSignOut?.apply(this,b)}),M(y,C)},m=y=>{var C=jt();M(y,C)};W(T,y=>{i.isLoggedIn?y(t):y(m,!1)})}d(f),d(a),d(g),d(r),U(()=>{P(c,i.title),P(S,` ${i.credits??""} Credits`)}),M(e,r)}Ve(["click"]);var zt=O('<div class="text-center py-20 animate-fade-in"><div class="inline-flex items-center justify-center w-20 h-20 rounded-3xl bg-slate-50 mb-6 text-slate-300"><svg class="h-10 w-10" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"></path></svg></div> <h3 class="text-lg font-bold text-slate-800">No Generations Yet</h3> <p class="mt-2 text-slate-500 max-w-xs mx-auto"> </p></div>');function Dt(e,i){var r=zt(),g=x(o(r),4),_=o(g,!0);d(g),d(r),U(()=>P(_,i.message)),M(e,r)}var Lt=O('<label class="flex items-center gap-2 cursor-pointer"><input type="checkbox" class="w-4 h-4 rounded text-primary focus:ring-primary"/> <span class="text-sm font-medium text-slate-600">Include Images (+1 Credit)</span></label>'),Rt=O('<a target="_blank" rel="noopener noreferrer" download="" class="px-6 py-3 bg-primary text-white font-bold rounded-xl hover:opacity-90 transition-all shadow-md flex items-center gap-2"><svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a2 2 0 002 2h12a2 2 0 002-2v-1m-4-4l-4 4m0 0l-4-4m4 4V4"></path></svg> Download Now</a>'),Wt=O('<div class="p-12 text-center"><!></div>'),Ut=Ne('<svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 21h10a2 2 0 002-2V9.414a1 1 0 00-.293-.707l-5.414-5.414A1 1 0 0012.586 3H7a2 2 0 00-2 2v14a2 2 0 002 2z"></path><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 13h6m-3-3v6"></path></svg>'),Pt=Ne('<svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path></svg>'),Yt=O('<div class="px-8 py-6 flex items-center justify-between hover:bg-slate-50 transition-colors"><div class="flex items-center gap-4"><div><!></div> <div class="font-bold text-slate-900"> </div></div> <a target="_blank" rel="noopener noreferrer" download="" class="p-2 text-slate-400 hover:text-primary transition-colors"><svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a2 2 0 002 2h12a2 2 0 002-2v-1m-4-4l-4 4m0 0l-4-4m4 4V4"></path></svg></a></div>'),Gt=O('<!> <main class="max-w-7xl mx-auto px-4 py-12"><div class="grid grid-cols-1 lg:grid-cols-12 gap-10"><div class="lg:col-span-8 space-y-8"><div class="bg-white p-8 rounded-3xl border border-slate-200 shadow-sm"><div class="flex items-center justify-between mb-8"><h3 class="text-xl font-bold text-slate-900">Forge Magic</h3> <div class="flex p-1 bg-slate-100 rounded-xl"><button>Lesson Plan</button> <button>Presentation</button></div></div> <textarea class="w-full h-40 p-6 bg-slate-50 border border-slate-200 rounded-2xl outline-none text-slate-700" placeholder="A B1 level lesson about..."></textarea> <div class="mt-6 flex items-center justify-between"><div class="flex items-center gap-6"><!> <div class="text-sm font-medium text-slate-500">Cost: <span class="text-primary font-bold"> </span></div></div> <div class="flex items-center gap-4"><!> <!></div></div></div> <div class="bg-white rounded-3xl border border-slate-200 shadow-sm overflow-hidden"><div class="px-8 py-6 border-b border-slate-100"><h3 class="font-bold text-slate-900">Recent Activity</h3></div> <div class="divide-y divide-slate-50"><!></div></div></div> <div class="lg:col-span-4"><div class="p-8 bg-primary rounded-3xl text-white shadow-xl"><h3 class="text-xl font-bold mb-2">Fuel Your Forge</h3> <p class="text-white/70 text-sm mb-8">Unlock unlimited creativity.</p> <div class="space-y-4"><button class="w-full bg-white text-primary font-bold py-4 rounded-2xl shadow-md hover:-translate-y-1 transition-all">10 Credits | $9.99</button> <button class="w-full bg-accent text-primary font-extrabold py-5 rounded-2xl shadow-lg relative hover:-translate-y-1 transition-all"><span class="absolute -top-3 left-1/2 -translate-x-1/2 bg-secondary text-white text-[10px] px-3 py-1 rounded-full uppercase tracking-wider font-bold">Popular</span> 50 Credits | $39.99</button></div></div></div></div></main>',1);function ea(e,i){bt(i,!0);let r=H(!1),g=H(0),_=H(""),p=H(!1),c=H(""),a=H(!1),n=H("lesson"),v=H(wt([])),f=H(""),h=ae(()=>s(n)==="lesson"?1:s(a)?2:1);et(()=>{(async()=>{const{data:{user:u}}=await R.auth.getUser();return u&&(k(r,!0),k(_,u.email||"",!0),await T(u.id),await t(u.id)),R.auth.onAuthStateChange((N,V)=>{m(V)})})()});async function S(){if(!(!s(r)||!s(c))){k(p,!0),k(f,"");try{const{data:{session:l}}=await R.auth.getSession(),u=await fetch("http://localhost:8080/api/generate",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${l?.access_token}`},body:JSON.stringify({prompt:s(c),mode:s(n),includeImages:s(a)})});if(!u.ok)throw new Error("Forge failed.");const N=await u.json();if(N.file){const I=N.file;if(I.startsWith("http"))k(f,I,!0);else{const q=I.startsWith("/")?I:`/${I}`;k(f,`http://localhost:8080${q}`)}const G={id:crypto.randomUUID(),prompt:s(c),file_path:s(f),created_at:new Date().toISOString()};k(v,[G,...s(v)],!0)}const{data:{user:V}}=await R.auth.getUser();V&&await T(V.id)}catch(l){console.error("Forge failed",l)}finally{k(p,!1)}}}async function T(l){const{data:u}=await R.from("users").select("credit_balance").eq("id",l).single();u&&k(g,u.credit_balance,!0)}async function t(l){const{data:u}=await R.from("generations").select("*").eq("user_id",l).order("created_at",{ascending:!1});u&&k(v,u,!0)}async function m(l){l?(k(r,!0),k(_,l.user.email,!0),await T(l.user.id),await t(l.user.id)):(k(r,!1),k(g,0),k(v,[],!0))}async function y(){await R.auth.signOut()}function C(l){window.location.href=l}var b=Gt(),A=de(b);Vt(A,{title:"Lesson Forge",get email(){return s(_)},get credits(){return s(g)},get isLoggedIn(){return s(r)},onSignOut:y});var B=x(A,2),E=o(B),j=o(E),F=o(j),w=o(F),Z=x(o(w),2),Y=o(Z),fe=x(Y,2);d(Z),d(w);var re=x(w,2);kt(re);var ue=x(re,2),se=o(ue),pe=o(se);{var ze=l=>{var u=Lt(),N=o(u);It(N),He(2),d(u),At(N,()=>s(a),V=>k(a,V)),M(l,u)};W(pe,l=>{s(n)==="ppt"&&l(ze)})}var he=x(pe,2),ge=x(o(he)),De=o(ge);d(ge),d(he),d(se);var xe=x(se,2),me=o(xe);{var Le=l=>{var u=Rt();U(()=>Te(u,"href",s(f))),M(l,u)};W(me,l=>{s(f)&&l(Le)})}var Re=x(me,2);{let l=ae(()=>s(p)?"Forging...":"Forge Magic"),u=ae(()=>!s(r)||!s(c));Ct(Re,{get text(){return s(l)},get isLoading(){return s(p)},get disabled(){return s(u)},onclick:S})}d(xe),d(ue),d(F);var _e=x(F,2),be=x(o(_e),2),We=o(be);{var Ue=l=>{var u=Wt(),N=o(u);Dt(N,{message:"Your forge is cold."}),d(u),M(l,u)},Pe=l=>{var u=Ze(),N=de(u);Bt(N,17,()=>s(v),Mt,(V,I)=>{var G=Yt(),q=o(G),ee=o(q),Ge=o(ee);{var qe=z=>{var J=Ut();M(z,J)},Je=ae(()=>s(I).file_path.endsWith(".pptx")),$e=z=>{var J=Pt();M(z,J)};W(Ge,z=>{s(Je)?z(qe):z($e,!1)})}d(ee);var Ee=x(ee,2),Ke=o(Ee);d(Ee),d(q);var Xe=x(q,2);d(G),U((z,J,Qe)=>{le(ee,1,`w-10 h-10 rounded-xl flex items-center justify-center ${z??""}`),P(Ke,`${J??""}...`),Te(Xe,"href",Qe)},[()=>s(I).file_path.endsWith(".pptx")?"bg-orange-100 text-orange-600":"bg-slate-100 text-slate-500",()=>s(I).prompt.substring(0,40),()=>s(I).file_path.startsWith("http")?s(I).file_path:`http://localhost:8080${s(I).file_path.startsWith("/")?s(I).file_path:"/"+s(I).file_path}`]),M(V,G)}),M(l,u)};W(We,l=>{s(v).length===0?l(Ue):l(Pe,!1)})}d(be),d(_e),d(j);var we=x(j,2),ye=o(we),ke=x(o(ye),4),Ce=o(ke),Ye=x(Ce,2);d(ke),d(ye),d(we),d(E),d(B),U(()=>{le(Y,1,`px-4 py-2 text-sm font-bold rounded-lg ${s(n)==="lesson"?"bg-white text-primary shadow-sm":"text-slate-500"}`),le(fe,1,`px-4 py-2 text-sm font-bold rounded-lg ${s(n)==="ppt"?"bg-white text-primary shadow-sm":"text-slate-500"}`),P(De,`${s(h)??""} Credits`)}),X("click",Y,()=>k(n,"lesson")),X("click",fe,()=>k(n,"ppt")),Et(re,()=>s(c),l=>k(c,l)),X("click",Ce,()=>C("https://buy.stripe.com/9B600lb2D6951Io1JsbjW03")),X("click",Ye,()=>C("https://buy.stripe.com/9B64gBb2D695eva3RAbjW04")),M(e,b),yt()}Ve(["click"]);export{ea as component};
