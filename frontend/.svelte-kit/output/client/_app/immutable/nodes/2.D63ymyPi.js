import{a as T,f as H,c as Je,b as Se}from"../chunks/C3rKXLWF.js";import{o as Ke}from"../chunks/BsAtrqI-.js";import{m as B,J as Xe,G as Te,g as i,K as Qe,M as We,N as Ce,O as te,P as K,o as $,a9 as Fe,aa as Ze,ab as Me,f as et,l as ue,ac as tt,v as at,_ as rt,ad as st,ae as xe,af as nt,ag as Ae,ah as it,ai as lt,aj as ot,k as fe,ak as R,h as He,j as Le,al as oe,am as dt,an as ct,i as ut,ao as ve,ap as ft,aq as vt,a2 as pt,t as X,e as d,c as _,r as c,I as pe,n as ee,p as gt,s as P,b as ht,a as xt,d as M,ar as mt,as as bt,u as de,at as _t}from"../chunks/DGkkJ6Jd.js";import{d as Oe,s as D,a as ge}from"../chunks/859_MDgp.js";import{i as G}from"../chunks/BBOZHhJG.js";import{B as wt,b as yt,s as ce,a as kt,r as Et,c as Ct}from"../chunks/CXIGT_Ll.js";import{s as V}from"../chunks/DmQzkQKc.js";function Mt(e,n){return n}function At(e,n,a){for(var p=[],x=n.length,o,u=n.length,r=0;r<x;r++){let v=n[r];Le(v,()=>{if(o){if(o.pending.delete(v),o.done.add(v),o.pending.size===0){var I=e.outrogroups;he(xe(o.done)),I.delete(o),I.size===0&&(e.outrogroups=null)}}else u-=1},!1)}if(u===0){var s=p.length===0&&a!==null;if(s){var f=a,g=f.parentNode;ct(g),g.append(f),e.items.clear()}he(n,!s)}else o={pending:new Set(n),done:new Set},(e.outrogroups??=new Set).add(o)}function he(e,n=!0){for(var a=0;a<e.length;a++)ut(e[a],n)}var Ie;function It(e,n,a,p,x,o=null){var u=e,r=new Map;B&&Xe();var s=null,f=rt(()=>{var b=a();return st(b)?b:b==null?[]:xe(b)}),g,v=!0;function I(){t.fallback=s,St(t,g,u,n,p),s!==null&&(g.length===0?(s.f&R)===0?He(s):(s.f^=R,J(s,null,u)):Le(s,()=>{s=null}))}var j=Te(()=>{g=i(f);var b=g.length;let w=!1;if(B){var C=Qe(u)===We;C!==(b===0)&&(u=Ce(),te(u),K(!1),w=!0)}for(var y=new Set,S=et,F=at(),A=0;A<b;A+=1){B&&$.nodeType===Fe&&$.data===Ze&&(u=$,w=!0,K(!1));var L=g[A],O=p(L,A),k=v?null:r.get(O);k?(k.v&&Me(k.v,L),k.i&&Me(k.i,A),F&&S.unskip_effect(k.e)):(k=Tt(r,v?u:Ie??=fe(),L,O,A,x,n,a),v||(k.e.f|=R),r.set(O,k)),y.add(O)}if(b===0&&o&&!s&&(v?s=ue(()=>o(u)):(s=ue(()=>o(Ie??=fe())),s.f|=R)),b>y.size&&tt(),B&&b>0&&te(Ce()),!v)if(F){for(const[Q,W]of r)y.has(Q)||S.skip_effect(W.e);S.oncommit(I),S.ondiscard(()=>{})}else I();w&&K(!0),i(f)}),t={effect:j,items:r,outrogroups:null,fallback:s};v=!1,B&&(u=$)}function Y(e){for(;e!==null&&(e.f&dt)===0;)e=e.next;return e}function St(e,n,a,p,x){var o=n.length,u=e.items,r=Y(e.effect.first),s,f=null,g=[],v=[],I,j,t,b;for(b=0;b<o;b+=1){if(I=n[b],j=x(I,b),t=u.get(j).e,e.outrogroups!==null)for(const k of e.outrogroups)k.pending.delete(t),k.done.delete(t);if((t.f&R)!==0)if(t.f^=R,t===r)J(t,null,a);else{var w=f?f.next:r;t===e.effect.last&&(e.effect.last=t.prev),t.prev&&(t.prev.next=t.next),t.next&&(t.next.prev=t.prev),z(e,f,t),z(e,t,w),J(t,w,a),f=t,g=[],v=[],r=Y(f.next);continue}if((t.f&oe)!==0&&He(t),t!==r){if(s!==void 0&&s.has(t)){if(g.length<v.length){var C=v[0],y;f=C.prev;var S=g[0],F=g[g.length-1];for(y=0;y<g.length;y+=1)J(g[y],C,a);for(y=0;y<v.length;y+=1)s.delete(v[y]);z(e,S.prev,F.next),z(e,f,S),z(e,F,C),r=C,f=F,b-=1,g=[],v=[]}else s.delete(t),J(t,r,a),z(e,t.prev,t.next),z(e,t,f===null?e.effect.first:f.next),z(e,f,t),f=t;continue}for(g=[],v=[];r!==null&&r!==t;)(s??=new Set).add(r),v.push(r),r=Y(r.next);if(r===null)continue}(t.f&R)===0&&g.push(t),f=t,r=Y(t.next)}if(e.outrogroups!==null){for(const k of e.outrogroups)k.pending.size===0&&(he(xe(k.done)),e.outrogroups?.delete(k));e.outrogroups.size===0&&(e.outrogroups=null)}if(r!==null||s!==void 0){var A=[];if(s!==void 0)for(t of s)(t.f&oe)===0&&A.push(t);for(;r!==null;)(r.f&oe)===0&&r!==e.fallback&&A.push(r),r=Y(r.next);var L=A.length;if(L>0){var O=null;At(e,A,O)}}}function Tt(e,n,a,p,x,o,u,r){var s=(u&it)!==0?(u&lt)===0?ot(a,!1,!1):Ae(a):null,f=(u&nt)!==0?Ae(x):null;return{v:s,i:f,e:ue(()=>(o(n,s??a,f??x,r),()=>{e.delete(p)}))}}function J(e,n,a){if(e.nodes)for(var p=e.nodes.start,x=e.nodes.end,o=n&&(n.f&R)===0?n.nodes.start:a;p!==null;){var u=ve(p);if(o.before(p),p===x)return;p=u}}function z(e,n,a){n===null?e.effect.first=a:n.next=a,a===null?e.effect.last=n:a.prev=n}function Ft(e,n){let a=null,p=B;var x;if(B){a=$;for(var o=pt(document.head);o!==null&&(o.nodeType!==Fe||o.data!==e);)o=ve(o);if(o===null)K(!1);else{var u=ve(o);o.remove(),te(u)}}B||(x=document.head.appendChild(fe()));try{Te(()=>n(x),ft|vt)}finally{p&&(K(!0),te(a))}}var Ht=H('<div class="hidden md:flex flex-col items-end"><span class="text-xs font-bold uppercase tracking-wider text-slate-400">Account</span> <span class="text-sm font-semibold text-slate-600"> </span></div> <div class="h-10 w-px bg-slate-200 hidden md:block"></div>',1),Lt=H('<button class="text-sm font-bold text-slate-400 hover:text-red-500 transition-all">Sign Out</button>'),Ot=H('<a href="/login" class="text-sm font-bold text-primary hover:text-primary/80 transition-all">Sign In</a>'),jt=H('<header class="glass sticky top-0 z-50 border-b border-white/40"><div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 h-20 flex items-center justify-between"><a href="/" class="flex items-center gap-3 hover:opacity-80 transition-opacity"><div class="w-10 h-10 bg-primary rounded-xl flex items-center justify-center shadow-lg shadow-primary/20"><svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"></path></svg></div> <h1 class="text-2xl font-extrabold tracking-tight text-primary"> </h1></a> <div class="flex items-center gap-6"><!> <div class="flex items-center gap-3"><span class="flex items-center gap-1.5 text-sm font-bold bg-primary/10 text-primary px-4 py-2 rounded-full border border-primary/10"><span class="w-2 h-2 rounded-full bg-primary animate-pulse"></span> </span> <!></div></div></div></header>');function Nt(e,n){var a=jt(),p=d(a),x=d(p),o=_(d(x),2),u=d(o,!0);c(o),c(x);var r=_(x,2),s=d(r);{var f=w=>{var C=Ht(),y=pe(C),S=_(d(y),2),F=d(S,!0);c(S),c(y),ee(2),X(()=>D(F,n.email)),T(w,C)};G(s,w=>{n.isLoggedIn&&w(f)})}var g=_(s,2),v=d(g),I=_(d(v));c(v);var j=_(v,2);{var t=w=>{var C=Lt();ge("click",C,function(...y){n.onSignOut?.apply(this,y)}),T(w,C)},b=w=>{var C=Ot();T(w,C)};G(j,w=>{n.isLoggedIn?w(t):w(b,!1)})}c(g),c(r),c(p),c(a),X(()=>{D(u,n.title),D(I,` ${n.credits??""} Credits`)}),T(e,a)}Oe(["click"]);var Pt=H('<div class="text-center py-20 animate-fade-in"><div class="inline-flex items-center justify-center w-20 h-20 rounded-3xl bg-slate-50 mb-6 text-slate-300"><svg class="h-10 w-10" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"></path></svg></div> <h3 class="text-lg font-bold text-slate-800">No Generations Yet</h3> <p class="mt-2 text-slate-500 max-w-xs mx-auto"> </p></div>');function zt(e,n){var a=Pt(),p=_(d(a),4),x=d(p,!0);c(p),c(a),X(()=>D(x,n.message)),T(e,a)}var Bt=H(`<div class="p-4 bg-slate-50 rounded-2xl border-2 border-slate-100 flex items-center justify-between group hover:border-accent transition-colors"><div class="flex items-center gap-4"><div class="w-10 h-10 rounded-xl bg-white flex items-center justify-center text-accent shadow-sm"><svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"></path></svg></div> <div><h4 class="text-sm font-bold text-slate-800">Include AI Images</h4> <p class="text-xs text-slate-500">Add 4-6 high-quality images</p></div></div> <label class="relative inline-flex items-center cursor-pointer"><input type="checkbox" class="sr-only peer"/> <div class="w-11 h-6 bg-slate-200 rounded-full peer peer-checked:after:translate-x-full peer-checked:bg-primary after:content-[''] after:absolute after:top-[2px] after:start-[2px] after:bg-white after:rounded-full after:h-5 after:w-5 after:transition-all"></div></label></div>`),Rt=H('<span class="text-amber-600 font-bold text-[10px] uppercase tracking-wider bg-amber-50 px-3 py-1 rounded-full">Sign in to start forging</span>'),Vt=H('<div class="px-8 py-12"><!></div>'),Dt=Se('<svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path></svg>'),qt=Se('<svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 12l3-3 3 3 4-4M8 21l4-4 4 4M3 4h18M4 4h16v12a1 1 0 01-1 1H5a1 1 0 01-1-1V4z"></path></svg>'),Gt=H('<div class="px-8 py-6 flex items-center justify-between hover:bg-slate-50/50 transition-colors group"><div class="flex items-center gap-4"><div><!></div> <div><h4 class="text-sm font-bold text-slate-800 line-clamp-1"> </h4> <p class="text-xs text-slate-500 uppercase font-semibold"> </p></div></div> <div class="flex items-center gap-3"><button class="p-2 text-slate-400 hover:text-primary transition-colors"><svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a2 2 0 002 2h12a2 2 0 002-2v-1m-4-4l-4 4m0 0l-4-4m4 4V4"></path></svg></button></div></div>'),Ut=H('<!> <main class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12"><div class="text-center mb-16"><h2 class="text-4xl md:text-5xl font-extrabold text-slate-900 tracking-tight mb-4">Helping Forge Future <span class="text-primary italic">Minds</span></h2> <p class="text-lg text-slate-500 max-w-2xl mx-auto">Generate high-quality presentations and lesson plans in seconds.</p></div> <div class="grid grid-cols-1 lg:grid-cols-12 gap-10"><div class="lg:col-span-8 space-y-8"><div class="card-premium p-8 relative overflow-hidden bg-white border rounded-3xl shadow-sm"><div class="flex flex-col sm:flex-row sm:items-center justify-between gap-4 mb-8"><h3 class="text-xl font-bold text-slate-800 flex items-center gap-2">Forge Magic</h3> <div class="flex p-1 bg-slate-100 rounded-xl relative z-10"><button>Lesson Plan</button> <button>Presentation</button></div></div> <div class="space-y-6"><div><label for="prompt" class="block text-sm font-bold text-slate-700 mb-2 uppercase tracking-wide"> </label> <textarea id="prompt" rows="5" class="w-full px-5 py-4 bg-slate-50 border-2 border-slate-100 rounded-2xl focus:ring-4 focus:ring-primary/10 focus:border-primary focus:bg-white transition-all text-slate-800"></textarea></div> <!> <div class="flex items-center justify-between pt-4 border-t border-slate-100"><div class="text-sm text-slate-500"><!></div> <!></div></div></div> <div class="card-premium overflow-hidden bg-white border rounded-3xl shadow-sm"><div class="px-8 py-6 border-b border-slate-100 flex items-center justify-between bg-slate-50/50"><h3 class="text-lg font-bold text-slate-800 flex items-center gap-2">Recent Activity</h3></div> <div class="divide-y divide-slate-50"><!></div></div></div> <div class="lg:col-span-4 space-y-8"><div class="p-8 bg-primary rounded-3xl text-white shadow-xl"><h3 class="text-xl font-bold mb-2">Fuel Your Forge</h3> <p class="text-white/70 text-sm mb-8">Unlock unlimited creativity with credit bundles.</p> <div class="space-y-4"><button class="w-full bg-white text-primary font-bold py-4 rounded-2xl shadow-xl hover:-translate-y-1 transition-all">10 Credits | $9.99</button> <button class="w-full bg-accent text-primary font-extrabold py-5 rounded-2xl shadow-2xl relative"><span class="absolute -top-3 left-1/2 -translate-x-1/2 bg-secondary text-white text-[10px] px-3 py-1 rounded-full">Popular</span> 50 Credits | $39.99</button></div></div></div></div></main>',1);function Zt(e,n){gt(n,!0);let a=P(!1),p=P(0),x=P(""),o=P(!1),u=P(""),r=P(!1),s=P("ppt"),f=P(ht([])),g=de(()=>i(s)==="lesson"?1:i(r)?2:1);Ke(()=>{const h=(async()=>{const{data:{user:m}}=await V.auth.getUser();m&&(M(a,!0),M(x,m.email||"",!0),await v(m.id),await I(m.id));const{data:{subscription:E}}=V.auth.onAuthStateChange((N,U)=>{j(U)});return E})();return()=>{h.then(m=>m?.unsubscribe())}});async function v(l){const{data:h,error:m}=await V.from("users").select("credit_balance").eq("id",l).single();h?M(p,h.credit_balance,!0):m&&console.warn("UI sync error (credits):",m.message)}async function I(l){console.log("ðŸ› ï¸ fetchHistory started for user:",l);const{data:h,error:m}=await V.from("generations").select("*").eq("user_id",l).order("created_at",{ascending:!1});if(m){console.error("âŒ Supabase Error fetching history:",m.message);return}console.log("ðŸ“¦ Data received from DB:",h),h&&(M(f,h.map(E=>({id:E.id,title:E.prompt.substring(0,30)+(E.prompt.length>30?"...":""),type:E.file_path?.includes("lesson")?"lesson":"ppt",date:new Date(E.created_at).toLocaleDateString(),status:E.status,hasPPT:E.file_path?.includes("ppt")||E.status==="completed",hasLesson:E.file_path?.includes("lesson")||E.status==="completed"})),!0),console.log("âœ¨ History state updated. Items count:",i(f).length))}async function j(l){l?(M(a,!0),M(x,l.user.email,!0),await v(l.user.id),await I(l.user.id)):(M(a,!1),M(p,0),M(x,""),M(f,[],!0))}async function t(){await V.auth.signOut()}async function b(){if(!(!i(a)||!i(u))){if(i(p)<i(g)){alert("Insufficient credits. Please top up your forge!");return}M(o,!0);try{const{data:{session:l}}=await V.auth.getSession();if(!l)throw new Error("Authentication session expired.");const h=await fetch("http://localhost:8080/api/generate",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${l.access_token}`},body:JSON.stringify({prompt:i(u),mode:i(s)==="ppt"?"pptx":"lesson",includeImages:i(r)})});if(!h.ok){const E=await h.text();throw new Error(E||"The forge failed to strike.")}const{data:{user:m}}=await V.auth.getUser();m&&(await v(m.id),await I(m.id)),M(u,""),alert("Magic Forged! Check your Recent Activity.")}catch(l){console.error("Forge Error:",l),alert(`Error: ${l.message}`)}finally{M(o,!1)}}}var w=Ut();Ft("1uha8ag",l=>{mt(()=>{_t.title="Lesson Forge | AI Lesson Planner"})});var C=pe(w);Nt(C,{title:"Lesson Forge",get email(){return i(x)},get credits(){return i(p)},get isLoggedIn(){return i(a)},onSignOut:t});var y=_(C,2),S=_(d(y),2),F=d(S),A=d(F),L=d(A),O=_(d(L),2),k=d(O),Q=_(k,2);c(O),c(L);var W=_(L,2),ae=d(W),re=d(ae),je=d(re,!0);c(re);var se=_(re,2);bt(se),c(ae);var me=_(ae,2);{var Ne=l=>{var h=Bt(),m=_(d(h),2),E=d(m);Et(E),ee(2),c(m),c(h),Ct(E,()=>i(r),N=>M(r,N)),T(l,h)};G(me,l=>{i(s)==="ppt"&&l(Ne)})}var be=_(me,2),ne=d(be),Pe=d(ne);{var ze=l=>{var h=Rt();T(l,h)};G(Pe,l=>{i(a)||l(ze)})}c(ne);var Be=_(ne,2);{let l=de(()=>i(o)?"Forging...":`Generate (${i(g)} Credit${i(g)>1?"s":""})`),h=de(()=>!i(a)||!i(u));wt(Be,{get text(){return i(l)},get isLoading(){return i(o)},get disabled(){return i(h)},onclick:b})}c(be),c(W),c(A);var _e=_(A,2),we=_(d(_e),2),Re=d(we);{var Ve=l=>{var h=Vt(),m=d(h);zt(m,{message:"Your forged materials will appear here."}),c(h),T(l,h)},De=l=>{var h=Je(),m=pe(h);It(m,17,()=>i(f),Mt,(E,N)=>{var U=Gt(),ye=d(U),Z=d(ye),qe=d(Z);{var Ge=q=>{var le=Dt();T(q,le)},Ue=q=>{var le=qt();T(q,le)};G(qe,q=>{i(N).type==="lesson"?q(Ge):q(Ue,!1)})}c(Z);var ke=_(Z,2),ie=d(ke),Ye=d(ie,!0);c(ie);var Ee=_(ie,2),$e=d(Ee);c(Ee),c(ke),c(ye),ee(2),c(U),X(()=>{ce(Z,1,`w-10 h-10 rounded-xl flex items-center justify-center ${i(N).type==="lesson"?"bg-emerald-50 text-emerald-600":"bg-blue-50 text-blue-600"}`),D(Ye,i(N).title),D($e,`${i(N).type??""} â€¢ ${i(N).date??""}`)}),T(E,U)}),T(l,h)};G(Re,l=>{i(f).length===0?l(Ve):l(De,!1)})}c(we),c(_e),c(F),ee(2),c(S),c(y),X(()=>{ce(k,1,`px-4 py-2 text-sm font-bold rounded-lg transition-all ${i(s)==="lesson"?"bg-white text-primary shadow-sm":"text-slate-500"}`),ce(Q,1,`px-4 py-2 text-sm font-bold rounded-lg transition-all ${i(s)==="ppt"?"bg-white text-primary shadow-sm":"text-slate-500"}`),D(je,i(s)==="lesson"?"Topic & Objectives":"Presentation Context"),kt(se,"placeholder",i(s)==="lesson"?"E.g., A lesson for beginner adults about grocery shopping...":"E.g., Presentation about remote team management...")}),ge("click",k,()=>M(s,"lesson")),ge("click",Q,()=>M(s,"ppt")),yt(se,()=>i(u),l=>M(u,l)),T(e,w),xt()}Oe(["click"]);export{Zt as component};
