import{a as L,f as z,c as Pe}from"../chunks/CFHtMSnc.js";import{o as Je}from"../chunks/DjQGscSg.js";import{m as Y,J as Ue,G as qe,g as o,K as We,M as Ke,N as _e,O as we,P as re,o as q,a1 as Xe,a2 as Qe,a3 as ye,f as Ze,l as le,a4 as $e,v as et,_ as tt,a5 as at,a6 as de,a7 as rt,a8 as ke,a9 as st,aa as nt,ab as it,k as Ce,ac as j,h as Ae,j as Be,ad as se,ae as lt,af as ot,i as dt,ag as vt,t as V,e as i,c as g,r as l,I as Fe,n as ct,p as ut,s as N,b as ft,a as pt,d as C,ah as ht,u as ne}from"../chunks/Cc-YLYwh.js";import{d as Me,s as D,a as P}from"../chunks/CapGnVIO.js";import{i as W}from"../chunks/D_9wn8cK.js";import{B as gt,b as xt,s as Ee,a as ie}from"../chunks/DOilt_PU.js";import{s as H}from"../chunks/BfHaHi3u.js";function mt(e,s){return s}function bt(e,s,r){for(var p=[],b=s.length,u,c=s.length,a=0;a<b;a++){let f=s[a];Be(f,()=>{if(u){if(u.pending.delete(f),u.done.add(f),u.pending.size===0){var A=e.outrogroups;oe(de(u.done)),A.delete(u),A.size===0&&(e.outrogroups=null)}}else c-=1},!1)}if(c===0){var n=p.length===0&&r!==null;if(n){var v=r,h=v.parentNode;ot(h),h.append(v),e.items.clear()}oe(s,!n)}else u={pending:new Set(s),done:new Set},(e.outrogroups??=new Set).add(u)}function oe(e,s=!0){for(var r=0;r<e.length;r++)dt(e[r],s)}var Se;function _t(e,s,r,p,b,u=null){var c=e,a=new Map;Y&&Ue();var n=null,v=tt(()=>{var m=r();return at(m)?m:m==null?[]:de(m)}),h,f=!0;function A(){t.fallback=n,wt(t,h,c,s,p),n!==null&&(h.length===0?(n.f&j)===0?Ae(n):(n.f^=j,J(n,null,c)):Be(n,()=>{n=null}))}var F=qe(()=>{h=o(v);var m=h.length;let _=!1;if(Y){var k=We(c)===Ke;k!==(m===0)&&(c=_e(),we(c),re(!1),_=!0)}for(var w=new Set,S=Ze,B=et(),E=0;E<m;E+=1){Y&&q.nodeType===Xe&&q.data===Qe&&(c=q,_=!0,re(!1));var M=h[E],I=p(M,E),y=f?null:a.get(I);y?(y.v&&ye(y.v,M),y.i&&ye(y.i,E),B&&S.unskip_effect(y.e)):(y=yt(a,f?c:Se??=Ce(),M,I,E,b,s,r),f||(y.e.f|=j),a.set(I,y)),w.add(I)}if(m===0&&u&&!n&&(f?n=le(()=>u(c)):(n=le(()=>u(Se??=Ce())),n.f|=j)),m>w.size&&$e(),Y&&m>0&&we(_e()),!f)if(B){for(const[R,U]of a)w.has(R)||S.skip_effect(U.e);S.oncommit(A),S.ondiscard(()=>{})}else A();_&&re(!0),o(v)}),t={effect:F,items:a,outrogroups:null,fallback:n};f=!1,Y&&(c=q)}function G(e){for(;e!==null&&(e.f&lt)===0;)e=e.next;return e}function wt(e,s,r,p,b){var u=s.length,c=e.items,a=G(e.effect.first),n,v=null,h=[],f=[],A,F,t,m;for(m=0;m<u;m+=1){if(A=s[m],F=b(A,m),t=c.get(F).e,e.outrogroups!==null)for(const y of e.outrogroups)y.pending.delete(t),y.done.delete(t);if((t.f&j)!==0)if(t.f^=j,t===a)J(t,null,r);else{var _=v?v.next:a;t===e.effect.last&&(e.effect.last=t.prev),t.prev&&(t.prev.next=t.next),t.next&&(t.next.prev=t.prev),O(e,v,t),O(e,t,_),J(t,_,r),v=t,h=[],f=[],a=G(v.next);continue}if((t.f&se)!==0&&Ae(t),t!==a){if(n!==void 0&&n.has(t)){if(h.length<f.length){var k=f[0],w;v=k.prev;var S=h[0],B=h[h.length-1];for(w=0;w<h.length;w+=1)J(h[w],k,r);for(w=0;w<f.length;w+=1)n.delete(f[w]);O(e,S.prev,B.next),O(e,v,S),O(e,B,k),a=k,v=B,m-=1,h=[],f=[]}else n.delete(t),J(t,a,r),O(e,t.prev,t.next),O(e,t,v===null?e.effect.first:v.next),O(e,v,t),v=t;continue}for(h=[],f=[];a!==null&&a!==t;)(n??=new Set).add(a),f.push(a),a=G(a.next);if(a===null)continue}(t.f&j)===0&&h.push(t),v=t,a=G(t.next)}if(e.outrogroups!==null){for(const y of e.outrogroups)y.pending.size===0&&(oe(de(y.done)),e.outrogroups?.delete(y));e.outrogroups.size===0&&(e.outrogroups=null)}if(a!==null||n!==void 0){var E=[];if(n!==void 0)for(t of n)(t.f&se)===0&&E.push(t);for(;a!==null;)(a.f&se)===0&&a!==e.fallback&&E.push(a),a=G(a.next);var M=E.length;if(M>0){var I=null;bt(e,E,I)}}}function yt(e,s,r,p,b,u,c,a){var n=(c&st)!==0?(c&nt)===0?it(r,!1,!1):ke(r):null,v=(c&rt)!==0?ke(b):null;return{v:n,i:v,e:le(()=>(u(s,n??r,v??b,a),()=>{e.delete(p)}))}}function J(e,s,r){if(e.nodes)for(var p=e.nodes.start,b=e.nodes.end,u=s&&(s.f&j)===0?s.nodes.start:r;p!==null;){var c=vt(p);if(u.before(p),p===b)return;p=c}}function O(e,s,r){s===null?e.effect.first=r:s.next=r,r===null?e.effect.last=s:r.prev=s}var kt=z('<div class="hidden md:flex flex-col items-end"><span class="text-xs font-bold uppercase tracking-wider text-slate-400">Account</span> <span class="text-sm font-semibold text-slate-600"> </span></div> <div class="h-10 w-px bg-slate-200 hidden md:block"></div>',1),Ct=z('<button class="text-sm font-bold text-slate-400 hover:text-red-500 transition-all">Sign Out</button>'),Et=z('<a href="/login" class="text-sm font-bold text-primary hover:text-primary/80 transition-all">Sign In</a>'),St=z('<header class="glass sticky top-0 z-50 border-b border-white/40"><div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 h-20 flex items-center justify-between"><a href="/" class="flex items-center gap-3 hover:opacity-80 transition-opacity"><div class="w-10 h-10 bg-primary rounded-xl flex items-center justify-center shadow-lg shadow-primary/20"><svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"></path></svg></div> <h1 class="text-2xl font-extrabold tracking-tight text-primary"> </h1></a> <div class="flex items-center gap-6"><!> <div class="flex items-center gap-3"><span class="flex items-center gap-1.5 text-sm font-bold bg-primary/10 text-primary px-4 py-2 rounded-full border border-primary/10"><span class="w-2 h-2 rounded-full bg-primary animate-pulse"></span> </span> <!></div></div></div></header>');function At(e,s){var r=St(),p=i(r),b=i(p),u=g(i(b),2),c=i(u,!0);l(u),l(b);var a=g(b,2),n=i(a);{var v=_=>{var k=kt(),w=Fe(k),S=g(i(w),2),B=i(S,!0);l(S),l(w),ct(2),V(()=>D(B,s.email)),L(_,k)};W(n,_=>{s.isLoggedIn&&_(v)})}var h=g(n,2),f=i(h),A=g(i(f));l(f);var F=g(f,2);{var t=_=>{var k=Ct();P("click",k,function(...w){s.onSignOut?.apply(this,w)}),L(_,k)},m=_=>{var k=Et();L(_,k)};W(F,_=>{s.isLoggedIn?_(t):_(m,!1)})}l(h),l(a),l(p),l(r),V(()=>{D(c,s.title),D(A,` ${s.credits??""} Credits`)}),L(e,r)}Me(["click"]);var Bt=z('<div class="text-center py-20 animate-fade-in"><div class="inline-flex items-center justify-center w-20 h-20 rounded-3xl bg-slate-50 mb-6 text-slate-300"><svg class="h-10 w-10" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"></path></svg></div> <h3 class="text-lg font-bold text-slate-800">No Generations Yet</h3> <p class="mt-2 text-slate-500 max-w-xs mx-auto"> </p></div>');function Ft(e,s){var r=Bt(),p=g(i(r),4),b=i(p,!0);l(p),l(r),V(()=>D(b,s.message)),L(e,r)}var Mt=z('<div class="animate-bounce flex justify-center mt-4"><a target="_blank" class="bg-accent text-primary font-bold py-3 px-8 rounded-2xl shadow-lg flex items-center gap-2">Download Ready</a></div>'),It=z('<div class="bg-white p-6 rounded-3xl border border-slate-100 flex items-center justify-between hover:shadow-md transition-all group"><div class="flex items-center gap-4"><div class="w-12 h-12 rounded-2xl bg-slate-50 flex items-center justify-center text-slate-400 group-hover:bg-primary/5 group-hover:text-primary transition-colors"><svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path></svg></div> <div><p class="font-bold text-slate-900 line-clamp-1"> </p> <p class="text-xs text-slate-400"> </p></div></div> <a aria-label="Download generated file" target="_blank" class="p-3 rounded-xl bg-slate-50 text-slate-400 hover:bg-primary hover:text-white transition-all"><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a2 2 0 002 2h12a2 2 0 002-2v-1m-4-4l-4 4m0 0l-4-4m4 4V4"></path></svg></a></div>'),Tt=z('<div class="min-h-screen bg-[#F8FAFC]"><!> <main class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12"><div class="grid grid-cols-1 lg:grid-cols-12 gap-12"><div class="lg:col-span-8 space-y-8"><div class="bg-white rounded-3xl p-8 shadow-sm border border-slate-100"><h2 class="text-2xl font-bold text-slate-900 mb-6">Lesson Forge</h2> <div class="space-y-6"><div class="flex p-1 bg-slate-100 rounded-2xl w-fit"><button>Lesson Plan</button> <button>Presentation</button></div> <div class="relative"><textarea class="w-full h-40 p-6 bg-slate-50 border-none rounded-3xl focus:ring-2 focus:ring-primary/20 transition-all resize-none text-slate-700 placeholder:text-slate-400"></textarea></div> <div class="flex items-center justify-between bg-slate-50 p-4 rounded-2xl"><div class="flex items-center gap-3"><div class="w-10 h-10 rounded-full bg-primary/10 flex items-center justify-center text-primary"><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"></path></svg></div> <div><p class="text-sm font-bold text-slate-900"></p> <p class="text-xs text-slate-500"> </p></div></div> <!></div> <!></div></div> <div class="space-y-4"><h3 class="text-xl font-bold text-slate-900">Your Forge History</h3> <!></div></div> <div class="lg:col-span-4"><div class="p-8 bg-primary rounded-3xl text-white shadow-xl sticky top-8"><h3 class="text-xl font-bold mb-2">Fuel Your Forge</h3> <div class="space-y-4 mt-8"><button class="w-full bg-white text-primary font-bold py-4 rounded-2xl shadow-md hover:-translate-y-1 transition-all">10 Credits | $9.99</button> <button class="w-full bg-accent text-primary font-extrabold py-5 rounded-2xl shadow-lg relative hover:-translate-y-1 transition-all"><span class="absolute -top-3 left-1/2 -translate-x-1/2 bg-white text-primary text-[10px] px-3 py-1 rounded-full uppercase tracking-wider font-black">Best Value</span> 50 Credits | $39.99</button></div></div></div></div></main></div>');function Vt(e,s){ut(s,!0);let r=N(!1),p=N(0),b=N(""),u=N(!1),c=N(""),a=N("lesson"),n=N(ft([])),v=N(""),h=ne(()=>(o(a)==="lesson",1));Je(()=>{H.auth.getSession().then(({data:{session:x}})=>{f(x)});const{data:{subscription:d}}=H.auth.onAuthStateChange((x,T)=>{f(T)});return()=>d.unsubscribe()});async function f(d){d?(C(r,!0),C(b,d.user.email||"",!0),await F(),await t()):(C(r,!1),C(b,""),C(p,0),C(n,[],!0),C(v,""),C(c,""))}async function A(){await H.auth.signOut()}async function F(){const{data:{session:d}}=await H.auth.getSession();if(d)try{const x=await fetch("/api/user/credits",{headers:{Authorization:`Bearer ${d.access_token}`}});if(x.ok){const T=await x.json();C(p,T.credits,!0)}}catch(x){console.error(x)}}async function t(){const{data:{user:d}}=await H.auth.getUser();if(!d)return;const{data:x}=await H.from("generations").select("*").eq("user_id",d.id).order("created_at",{ascending:!1});x&&C(n,x,!0)}async function m(){if(!(!o(r)||!o(c)||o(u))){C(u,!0),C(v,"");try{const{data:{session:d}}=await H.auth.getSession(),x=await fetch("/api/generate",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${d?.access_token}`},body:JSON.stringify({prompt:o(c),mode:o(a)==="lesson"?"pdf":"ppt"})});if(!x.ok)throw new Error("Forge failed");const T=await x.json();C(v,T.file,!0),await F(),await t()}catch(d){alert(d)}finally{C(u,!1)}}}function _(d){window.location.href=d}var k=Tt(),w=i(k);At(w,{get isLoggedIn(){return o(r)},get credits(){return o(p)},get email(){return o(b)},title:"Lesson Forge",onSignOut:A});var S=g(w,2),B=i(S),E=i(B),M=i(E),I=g(i(M),2),y=i(I),R=i(y),U=g(R,2);l(y);var K=g(y,2),X=i(K);ht(X),l(K);var Q=g(K,2),Z=i(Q),ve=g(i(Z),2),ce=i(ve);ce.textContent=`Cost: ${o(h)??""} Credits`;var ue=g(ce,2),Ie=i(ue);l(ue),l(ve),l(Z);var Te=g(Z,2);{let d=ne(()=>o(u)||!o(c)||o(r)&&o(p)<o(h)),x=ne(()=>o(u)?"Forging...":"Forge Content");gt(Te,{onclick:m,get disabled(){return o(d)},variant:"primary",get text(){return o(x)}})}l(Q);var Le=g(Q,2);{var Ne=d=>{var x=Mt(),T=i(x);l(x),V(()=>ie(T,"href",o(v))),L(d,x)};W(Le,d=>{o(v)&&d(Ne)})}l(I),l(M);var fe=g(M,2),Oe=g(i(fe),2);{var je=d=>{Ft(d,{message:"Your generated lessons and presentations will appear here."})},ze=d=>{var x=Pe(),T=Fe(x);_t(T,17,()=>o(n),mt,(De,$)=>{var ee=It(),te=i(ee),me=g(i(te),2),ae=i(me),Ve=i(ae,!0);l(ae);var be=g(ae,2),Re=i(be,!0);l(be),l(me),l(te);var Ye=g(te,2);l(ee),V(Ge=>{D(Ve,o($).prompt),D(Re,Ge),ie(Ye,"href",o($).file_path)},[()=>new Date(o($).created_at).toLocaleDateString()]),L(De,ee)}),L(d,x)};W(Oe,d=>{o(n).length===0?d(je):d(ze,!1)})}l(fe),l(E);var pe=g(E,2),he=i(pe),ge=g(i(he),2),xe=i(ge),He=g(xe,2);l(ge),l(he),l(pe),l(B),l(S),l(k),V(()=>{Ee(R,1,`px-6 py-2 rounded-xl text-sm font-medium transition-all ${o(a)==="lesson"?"bg-white text-primary shadow-sm":"text-slate-500 hover:text-slate-700"}`),Ee(U,1,`px-6 py-2 rounded-xl text-sm font-medium transition-all ${o(a)==="slides"?"bg-white text-primary shadow-sm":"text-slate-500 hover:text-slate-700"}`),ie(X,"placeholder",o(a)==="lesson"?"e.g., A 45-minute ESL lesson...":"e.g., 5 slides about..."),D(Ie,`Current Balance: ${o(p)??""}`)}),P("click",R,()=>C(a,"lesson")),P("click",U,()=>C(a,"slides")),xt(X,()=>o(c),d=>C(c,d)),P("click",xe,()=>_("https://buy.stripe.com/9B600lb2D6951Io1JsbjW03")),P("click",He,()=>_("https://buy.stripe.com/9B64gBb2D695eva3RAbjW04")),L(e,k),pt()}Me(["click"]);export{Vt as component};
